<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>universe</title>
  <link rel="icon" type="image/png" href="/heart.png" sizes="16x16" />
  <link rel="stylesheet" href="./DEV303.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <!-- Importmap for THREE.js -->
  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.152.2/build/three.module.js",
        "three/addons/controls/OrbitControls.js": "https://unpkg.com/three@0.152.2/examples/jsm/controls/OrbitControls.js",
        "three/examples/jsm/loaders/FontLoader.js": "https://unpkg.com/three@0.152.2/examples/jsm/loaders/FontLoader.js",
        "three/examples/jsm/geometries/TextGeometry.js": "https://unpkg.com/three@0.152.2/examples/jsm/geometries/TextGeometry.js"
      }
    }
  </script>

  <!-- Custom Animations -->
  <style>
    @keyframes rotateSlow {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .animate-rotate-slow {
      animation: rotateSlow 4s linear infinite;
    }

    .animate-fade-in {
      animation: fadeIn 1s ease-out forwards;
    }

    .text-white {
      color: white !important;
    }

    .btn-audio-toggle {
      background-color: transparent;
      border: none;
      cursor: pointer;
      padding: 0;
    }

    .music-status {
      display: flex;
      position: fixed;
      top: 15px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      z-index: 9999;
      align-items: center;
      font-family: sans-serif;
      font-size: 14px;
    }

    .music-status .spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #a259f7;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      animation: spin 1s linear infinite;
      margin-right: 10px;
    }
  </style>
</head>

<body class="bg-black text-white">

  <!-- 3D Canvas -->
  <div id="container"></div>

  <!-- Landscape Warning -->
  <div id="landscape-warning" class="fixed inset-0 bg-black bg-opacity-90 text-white hidden items-center justify-center z-[9999]">
    <div class="flex flex-col items-center space-y-6 animate-fade-in">
      <!-- Phone Icon -->
      <div class="relative w-24 h-40 border-4 border-white rounded-2xl flex items-center justify-center">
        <div class="w-10 h-10 bg-white rounded-md"></div>
      </div>

      <!-- Rotating Arrow -->
      <div class="w-10 h-10 text-white animate-rotate-slow">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      </div>

      <!-- Message -->
      <div class="text-center px-6">
        <h2 class="text-lg font-semibold">Rotate Your Device</h2>
        <p class="text-sm text-gray-200">This experience is best viewed in landscape mode</p>
      </div>
    </div>
  </div>

  <!-- Optional overlays -->
  <div id="dark-overlay"></div>
  <div id="info"></div>

  <!-- Global Data -->
  <script>
    window.dataLove2Loveloom = {
      template: "galaxy",
      data: {
        keychain: { name: "TÊN NÈ", phone: ".......", address: "......." },
        ringTexts: ["CHỖ NÀY ĐẶT TÊN CHO VÀNH ĐAI"],
      }
    };
  </script>

  <!-- Your 3D JavaScript -->
  <script type="module" src="./script.js"></script>

  <!-- Music Manager -->
  <script>
    const musicManager = {
      audio: null,
      isPlaying: false,

      init() {
        this.audio = new Audio('./Ks.mp3');
        this.audio.loop = true;
        this.audio.volume = 0.7;
        this.audio.preload = "auto";

        this.audio.onplay = () => {
          this.isPlaying = true;
          this.updateUI();
        };

        this.audio.onpause = () => {
          this.isPlaying = false;
          this.updateUI();
        };

        this.updateUI();
      },

      togglePlayback() {
        if (!this.audio) return;
        if (this.audio.paused) {
          this.audio.play().catch(e => {
            console.warn('Lỗi phát nhạc:', e);
          });
        } else {
          this.audio.pause();
        }
      },

      updateUI() {
        const icon = document.getElementById('audio-icon');
        if (this.isPlaying) {
          icon.classList.remove('fa-volume-xmark');
          icon.classList.add('fa-volume-high');
        } else {
          icon.classList.remove('fa-volume-high');
          icon.classList.add('fa-volume-xmark');
        }
      }
    };

    let audioStarted = false;
    document.body.addEventListener('click', () => {
      if (audioStarted) return;
      const audio = new Audio('./e.mp3');
      audio.loop = true;
      audio.play().catch(() => {
        console.log("Không thể phát nhạc tự động.");
      });
      audioStarted = true;
    });
  </script>

  <!-- Orientation Check Script -->
  <script>
    function checkOrientation() {
      const isPortrait = window.innerHeight > window.innerWidth;
      const warning = document.getElementById("landscape-warning");
      if (isPortrait) {
        warning.classList.remove("hidden");
      } else {
        warning.classList.add("hidden");
      }
    }

    window.addEventListener("resize", checkOrientation);
    window.addEventListener("orientationchange", checkOrientation);
    window.addEventListener("load", checkOrientation);
  </script>

</body>

</html>
